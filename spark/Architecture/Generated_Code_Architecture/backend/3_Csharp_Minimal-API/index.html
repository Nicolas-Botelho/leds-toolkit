<!DOCTYPE html><meta charset="utf-8"><h1 id="c-minimal-api-architecture">C# Minimal API Architecture</h1><p>This document describes the backend project structure in <strong>C# Minimal API</strong>, organized into layers and modular folders to ensure scalability, testability, and clarity in responsibilities.</p><hr><h2 id="layered-architecture">Layered Architecture</h2><p>The backend follows a <strong>modular layered architecture</strong>, organizing components by domain and functionality. Each layer has a defined responsibility, as shown below:</p><pre class="astro-code github-dark" data-language="mermaid" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0"><code><span class="line"><span style="color:#e1e4e8">graph TD</span></span>
<span class="line"></span>
<span class="line"><span style="color:#e1e4e8">subgraph WebService</span></span>
<span class="line"><span style="color:#e1e4e8">    A[Webservice - Presentation Layer]</span></span>
<span class="line"><span style="color:#e1e4e8">    B[Moranguinho - Domain Layer]</span></span>
<span class="line"><span style="color:#e1e4e8">    C[Shared - Shared Components]</span></span>
<span class="line"><span style="color:#e1e4e8">end</span></span>
<span class="line"></span>
<span class="line"><span style="color:#e1e4e8">subgraph Moranguinho</span></span>
<span class="line"><span style="color:#e1e4e8">    B1[Agricultor.cs]</span></span>
<span class="line"><span style="color:#e1e4e8">    B2[Propriedade.cs]</span></span>
<span class="line"><span style="color:#e1e4e8">    B3[ContextDbFactory.cs]</span></span>
<span class="line"><span style="color:#e1e4e8">end</span></span>
<span class="line"></span>
<span class="line"><span style="color:#e1e4e8">subgraph Shared</span></span>
<span class="line"><span style="color:#e1e4e8">    C1[ContextDb - EF Core]</span></span>
<span class="line"><span style="color:#e1e4e8">end</span></span>
<span class="line"></span>
<span class="line"><span style="color:#e1e4e8">A --> B</span></span>
<span class="line"><span style="color:#e1e4e8">B --> C</span></span>
<span class="line"><span style="color:#e1e4e8">C --> C1</span></span></code></pre><h3 id="presentation-layer">Presentation Layer</h3><p>Located in the <code>Webservice/</code> folder.</p><ul><li>Contains the <code>Program.cs</code> file, responsible for configuring and exposing HTTP routes, middlewares (Swagger, CORS, authentication), and app services.</li><li>Acts as the UI of the API, handling direct interaction with clients.</li></ul><h3 id="domain-layer">Domain Layer</h3><p>Located in the <code>Moranguinho/</code> folder.</p><ul><li>Includes domain-specific logic and models such as <code>Agricultor.cs</code>, <code>Propriedade.cs</code>, and <code>ContextDbFactory.cs</code>.</li><li>Organizes code by feature, improving maintainability and separation of concerns.</li></ul><h3 id="shared-layer">Shared Layer</h3><p>Located in the <code>Shared/</code> folder.</p><ul><li>Provides cross-cutting utilities and shared components like models, enums, and helper classes.</li><li>Contains the <code>ContextDb/</code> subfolder, which handles database access using EF Core (Entity Framework Core).</li></ul><p>This structure enables a clean separation between domain logic, infrastructure, and service exposure.</p><hr><h2 id="main-folders">Main Folders</h2><h3 id="webservice">Webservice</h3><p>Service exposure layer of the application.</p><h4 id="programcs">Program.cs</h4><p>Initializes and configures the Minimal API app, sets up services, middlewares, and routes.</p><h4 id="endpoints-and-middleware">Endpoints and Middleware</h4><p>Responsible for exposing routes to external consumers, including Swagger setup, CORS policy, and authentication (if applicable).</p><hr><h3 id="moranguinho">Moranguinho</h3><p>Represents the core domain logic.</p><h4 id="agricultorcs">Agricultor.cs</h4><p>Defines the <code>Agricultor</code> entity and related domain logic.</p><h4 id="propriedadecs">Propriedade.cs</h4><p>Represents the <code>Propriedade</code> entity, modeling the domain structure for rural properties.</p><h4 id="contextdbfactorycs">ContextDbFactory.cs</h4><p>A factory class used to instantiate the <code>DbContext</code>, especially useful for dependency injection or testing scenarios.</p><hr><h3 id="shared">Shared</h3><p>Shared resources and infrastructure.</p><h4 id="contextdb">ContextDb/</h4><p>Contains:</p><ul><li><code>DbContext</code> definition used by EF Core</li><li>Entity configurations and model mappings</li><li>Responsible for database interaction (CRUD operations, migrations, etc.)</li></ul><p>Used across the entire application to maintain a centralized and consistent data access approach.</p><hr><h2 id="references">References</h2><ul><li><a href="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/minimal-apis">https://learn.microsoft.com/en-us/aspnet/core/fundamentals/minimal-apis</a></li><li><a href="https://www.infoq.com/articles/minimal-api-dotnet6/">https://www.infoq.com/articles/minimal-api-dotnet6/</a></li><li><a href="https://learn.microsoft.com/en-us/ef/core/">https://learn.microsoft.com/en-us/ef/core/</a></li></ul><hr><h2 id="improvement-points">Improvement Points</h2><ul><li><strong>Add Service Layer (optional):</strong> Including a service layer between endpoints and domain classes could improve the separation of business logic.</li><li><strong>Program.cs too big:</strong> Create the service layer, and routes configurations</li></ul>