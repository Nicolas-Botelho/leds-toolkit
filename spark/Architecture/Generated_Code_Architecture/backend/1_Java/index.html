<!DOCTYPE html><meta charset="utf-8"><h1 id="java-spark-architecture">Java Spark Architecture</h1><p>This document describes the backend project structure in <strong>Java Spark</strong>, organized in layers to facilitate maintenance, testability, and component reuse.</p><hr><h2 id="layered-architecture">Layered Architecture</h2><p>Backend development in Java was structured in layers, organizing the system in hierarchies, each with its own responsibilities. The division was made as follows:</p><pre class="astro-code github-dark" data-language="mermaid" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0"><code><span class="line"><span style="color:#e1e4e8">%%{init: {'theme': 'neutral'}}%%</span></span>
<span class="line"><span style="color:#e1e4e8">flowchart TB</span></span>
<span class="line"><span style="color:#e1e4e8">    subgraph "Java Spark Architecture"</span></span>
<span class="line"><span style="color:#e1e4e8">        subgraph DataLayer["Data Layer (entity)"]</span></span>
<span class="line"><span style="color:#e1e4e8">            Models["models/\nContains entity classes with\nJPA annotations"]</span></span>
<span class="line"><span style="color:#e1e4e8">            Repositories["repositories/\nJPA Repository interfaces\nfor database access"]</span></span>
<span class="line"><span style="color:#e1e4e8">            SQL["sql/\nSQL scripts for\ndata replication and\ndatabase constraints"]</span></span>
<span class="line"><span style="color:#e1e4e8">            Register["register/\nProject metadata"]</span></span>
<span class="line"><span style="color:#e1e4e8">            Resources1["resources/\nConfiguration files\n(application.properties)"]</span></span>
<span class="line"><span style="color:#e1e4e8">        end</span></span>
<span class="line"></span>
<span class="line"><span style="color:#e1e4e8">        subgraph ApplicationLayer["Application/API Layer (webservice)"]</span></span>
<span class="line"><span style="color:#e1e4e8">            Application["application/\nContains Application.java\n(Spring Boot initialization)"]</span></span>
<span class="line"><span style="color:#e1e4e8">            Controllers["controllers/\nREST/GraphQL controllers\nfor API endpoints"]</span></span>
<span class="line"><span style="color:#e1e4e8">            Records["records/\nData Transfer Objects\n(DTOs)"]</span></span>
<span class="line"><span style="color:#e1e4e8">            ReposWeb["repositories/\nAdapters between\ncontrollers and domain layer"]</span></span>
<span class="line"><span style="color:#e1e4e8">            GraphQL["resources/graphql/\nGraphQL schema definitions"]</span></span>
<span class="line"><span style="color:#e1e4e8">        end</span></span>
<span class="line"></span>
<span class="line"><span style="color:#e1e4e8">        %% Relationships between packages</span></span>
<span class="line"><span style="color:#e1e4e8">        DataLayer --> ApplicationLayer</span></span>
<span class="line"><span style="color:#e1e4e8">        Repositories --> ReposWeb</span></span>
<span class="line"><span style="color:#e1e4e8">        Models --> Records</span></span>
<span class="line"><span style="color:#e1e4e8">    end</span></span>
<span class="line"></span>
<span class="line"><span style="color:#e1e4e8">    %% External components</span></span>
<span class="line"><span style="color:#e1e4e8">    Frontend["Frontend\n(UI)"]</span></span>
<span class="line"><span style="color:#e1e4e8">    APIConsumers["API Consumers"]</span></span>
<span class="line"><span style="color:#e1e4e8">    Database["Database"]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#e1e4e8">    %% External relationships</span></span>
<span class="line"><span style="color:#e1e4e8">    Frontend --> Controllers</span></span>
<span class="line"><span style="color:#e1e4e8">    APIConsumers --> Controllers</span></span>
<span class="line"><span style="color:#e1e4e8">    Repositories --> Database</span></span></code></pre><h3 id="data-layer">Data Layer</h3><p>Responsible for entities and repositories (<code>entity/</code> folder).</p><h3 id="applicationapi-layer">Application/API Layer</h3><p>Includes controllers and exposed services (<code>webservice/</code> folder).</p><p>This structure facilitated maintenance, testability, and the reuse of components.</p><hr><h2 id="main-folders">Main Folders</h2><h3 id="entity">Entity</h3><h4 id="models">models/</h4><p>Contains Java classes corresponding to entities defined in the <code>.spark</code> file (e.g., <code>Agricultor</code>, <code>Propriedade</code>). These entities reflect database tables and include JPA annotations.</p><h4 id="repositories">repositories/</h4><p>Database access interfaces such as <code>AgricultorRepository.java</code>, which extend <code>JpaRepository</code> and are used for queries.</p><h4 id="sql">sql/</h4><p>SQL scripts useful for data replication setup and database constraint creation.</p><h4 id="register">register/</h4><p>Stores project metadata, such as the <code>morango-register.json</code> file, which registers information about created modules and entities.</p><h4 id="resources">resources/</h4><p>Application configuration files such as <code>application.properties</code>, containing Spring Boot configurations.</p><h3 id="webservice">Webservice</h3><p>Service exposure layer of the application. This is where application logic interfaces with the outside world (frontend or API consumers).</p><h4 id="application">application/</h4><p>Contains the <code>Application.java</code> class that initializes the Spring Boot project.</p><h4 id="controllers">controllers/</h4><p>REST/GraphQL controllers generated for each entity. Handle requests and define endpoints.</p><h4 id="records">records/</h4><p>DTOs (Data Transfer Objects), which carry input and output data of the API. Example: <code>AgricultorInput.java</code>.</p><h4 id="repositories-1">repositories/</h4><p>Serve as adapters between controllers and domain-layer repositories.</p><h4 id="resourcesgraphql">resources/graphql/</h4><p>Contains the <code>schema.graphqls</code> file, which defines the types, queries, and mutations of the GraphQL API, based on the entities defined in the <code>.spark</code> file.</p><hr><h2 id="references">References</h2><ul><li><a href="https://www.alura.com.br/artigos/padroes-arquiteturais-arquitetura-software-descomplicada">https://www.alura.com.br/artigos/padroes-arquiteturais-arquitetura-software-descomplicada</a></li><li><a href="https://jeziellago.medium.com/padr%C3%B5es-de-arquitetura-de-software-parte-i-a1d23c323a40">https://jeziellago.medium.com/padr%C3%B5es-de-arquitetura-de-software-parte-i-a1d23c323a40</a></li></ul><hr><h2 id="improvement-points">Improvement Points</h2><ul><li><strong>Better naming of web repositories</strong>: <code>AgricultorRepositoryWeb.java</code> can be confused with <code>AgricultorRepository.java</code>. More specific names like <code>AgricultorGraphQLAdapter</code> would prevent such issues we encountered during analysis.</li><li><strong>Creation of a service layer</strong>: Adding an intermediate layer between controllers and repositories with pure business logic would increase separation of concerns.</li></ul>