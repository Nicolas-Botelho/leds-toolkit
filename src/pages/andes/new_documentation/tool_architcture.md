---
sidebar_position: 4
title: Andes Architecture
layout: '~/layouts/MarkdownLayout.astro'
---

## Overview

The project is divided into three main parts:

- **CLI (`src/cli/`)** → Command-line interface, responsible for interacting with the user via terminal and executing commands.  
- **Extension (`src/extension/`)** → Entry point for the extension (e.g., VSCode).  
- **Language (`src/language/`)** → DSL definitions (based on Langium), including grammar, validation, and scope.  

---

## Directory Structure

### `src/cli/`
Contains the implementation of the **CLI** and its utilities.

- **`artifacts/`**
  - **`bdd/`**
    - `BDDService.ts` → Main service for executing BDD scenarios.
    - `application.ts` → Application that integrates BDD with the rest of the CLI.
    - `generator.ts` → Generation of BDD-related files.
  - **`generative_ai/`**
    - `application.ts` → Integration with AI tools.
  - **`graph/`**
    - `graph.ts` → Graph manipulation and generation.
  - **`made/`**
    - `application.ts` → Service specific to generation/execution of *made* artifacts.
  - **`spark/`**
    - `application.ts` → Service specific to generation/execution of *spark* artifacts.
  - **`utils/`**
    - `envLoader.ts` → Utility for loading environment variables.

- **`vscode_utils/`**
  - `vscode-utils.ts` → Utility functions for integration with VSCode.
  
- **Main CLI files**
  - `cli-utils.ts` → Common functions for CLI execution.
  - `generator-utils.ts` → Helper functions for generators.
  - `generator.ts` → Orchestrator of artifact generation.
  - `main.ts` → CLI entry point.
  - `translate-utils.ts` → Translates objects generated by **Langium** into objects interpretable by the main library.

---

### `src/extension/`
Contains the extension (integration with VSCode).

- `main.ts` → Extension entry point, initializes communication between the editor and the language.

---

### `src/language/`
This is the **core of the DSL**, built with **Langium**.

- Language definition files:
  - `andes.langium` → Main grammar of the Andes language.
  - `entities.langium` → Entity definitions.
  - `helpers.langium` → Auxiliary rules.
  - `requirements.langium` → Requirement definitions.
  - `terminals.langium` → Token/terminal definitions.
  - `usecases.langium` → Use case definitions.

- Supporting TypeScript files:
  - `andes-module.ts` → Main module connecting the parts of the language.
  - `andes-scope.ts` → Scope rules and reference resolution.
  - `andes-validator.ts` → Semantic validations of the language.
  - `main.ts` → Language initialization entry point.
  - `main-browser.ts` → Initialization for browser environments.

---

## Architectural Flow

1. **User runs the CLI**  
   - Entry at `src/cli/main.ts`.  
   - Invokes modules such as BDD, graph generation, and *made/spark* files.  
   - When it needs to interpret language models, it uses `translate-utils.ts`.  

2. **Extension (VSCode)**  
   - Loaded via `src/extension/main.ts`.  
   - Uses the DSL definition in `src/language/` for parsing, validation, and scope.  
   - Displays feedback in the editor.  

3. **Language (Langium)**  
   - DSL defined in `.langium` files.  
   - Parsing + validation → generates AST.  
   - The **AST is translated by `translate-utils.ts`** into domain objects understood by the CLI modules.  

---
